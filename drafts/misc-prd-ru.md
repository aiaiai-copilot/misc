# MISC (MindSection) - Product Requirements Document

## 1. Обзор продукта

### 1.1 Описание
MISC - минималистичная система управления информацией, основанная на единственном принципе: всё есть теги. Каждая запись представляет собой набор слов (тегов), разделённых пробелами. Система устраняет барьер между мыслью и записью, предлагая мгновенную фиксацию и поиск информации без традиционных структур организации данных.

### 1.2 Ключевые принципы
- **Радикальная простота**: Один механизм для всех типов информации
- **Нулевой порог входа**: Не требует обучения
- **Скорость в приоритете**: Мгновенная фиксация мысли
- **Прозрачность**: Пользователь всегда понимает, как работает система

### 1.3 Целевые метрики
- Время до первой записи: < 10 секунд
- Время на обучение: < 1 минута
- Универсальность использования: 80% пользователей для 3+ типов информации
- Retention: 60% активных пользователей через месяц

## 2. Функциональные требования

### 2.1 Core функциональность

#### 2.1.1 Управление записями
- **Создание записи**: Ввод набора тегов через пробел
- **Поиск записей**: Поиск по любой комбинации тегов (логика AND)
- **Редактирование записи**: Полная замена содержимого записи
- **Удаление записи**: Безвозвратное удаление

#### 2.1.2 Работа с тегами
- **Определение тега**: Любая последовательность символов без пробелов
- **Ограничения тегов**: 
  - Запрещены служебные символы JSON: `{}[]:,"\`
  - Поддержка всех остальных Unicode символов
  - Автоматическое приведение к нижнему регистру (настраиваемо)
- **Уникальность записи**: Запись = уникальное множество тегов (порядок не важен для идентификации)

#### 2.1.3 Интерфейс поиска
- **Инкрементальный поиск**: Результаты обновляются при вводе
- **Облако тегов**: Отображается когда результаты не помещаются на экран
  - Размер тега пропорционален частоте использования
  - Клик по тегу добавляет его к поисковому запросу
- **Список записей**: Отображается когда результаты помещаются на экран
  - Сортировка по дате создания (новые сверху)
  - Отображение полного содержимого записи(по возможности)

### 2.2 Пользовательский интерфейс

#### 2.2.1 Основной интерфейс
- **Единое поле ввода**: Универсальное поле для поиска и создания записей
- **Адаптивное отображение**: 
  - Режим поиска по умолчанию
  - Предложение создать запись при отсутствии результатов
- **Минималистичный дизайн**: Фокус на содержимом, минимум визуальных элементов

#### 2.2.2 Управление клавиатурой
- **Enter**: Сохранить новую запись / Открыть выбранную для редактирования
- **Escape**: Очистить поле ввода
- **Tab**: Автодополнение тега
- **↑/↓**: Навигация по результатам поиска
- **Delete**: Удалить выбранную запись

#### 2.2.3 Автодополнение
- **Подсказки тегов**: На основе существующих тегов в системе
- **Момент появления**: Сразу при вводе символов
- **Опциональный живой поиск**: Отображение результатов во время ввода (настраиваемо)


### 2.3 Хранение данных

#### 2.3.1 Структура данных
- **Запись**: Множество UUID тегов + метаданные
- **Тег**: Строковое значение + уникальный UUID
- **Таблица соответствия**: Маппинг тег ↔ UUID

#### 2.3.2 Прототип: localStorage
- **Формат хранения**: JSON
- **Структура**:
```json
{
  "tags": {
    "uuid1": "тег1",
    "uuid2": "тег2"
  },
  "records": [
    {
      "id": "record-uuid",
      "tags": ["uuid1", "uuid2"],
      "tagOrder": ["uuid1", "uuid2"],
      "createdAt": "2024-01-01T00:00:00Z"
    }
  ],
  "settings": {
    "caseSensitive": false,
    "liveSearch": true
  }
}
```

### 2.4 Экспорт/Импорт

#### 2.4.1 Формат
- **Тип файла**: JSON
- **Включает**: Записи, теги, UUID, метаданные, настройки
- **Сохранение UUID**: При импорте используются существующие UUID

#### 2.4.2 Интерфейс
- **Доступ**: Через меню настроек
- **Экспорт**: Скачивание JSON файла
- **Импорт**: Загрузка JSON файла с валидацией

## 3. Нефункциональные требования

### 3.1 Производительность
- **Время отклика поиска**: < 100мс для 10,000 записей
- **Время сохранения**: < 50мс
- **Размер приложения**: < 500KB (gzipped)

### 3.2 Надёжность
- **Сохранение данных**: Автоматическое сохранение в localStorage
- **Валидация**: Проверка корректности тегов при вводе
- **Обработка ошибок**: Информативные сообщения пользователю

### 3.3 Юзабилити
- **Отзывчивый дизайн**: Адаптация под разные размеры экранов
- **Доступность**: Поддержка keyboard-only навигации
- **Обратная связь**: Визуальные индикаторы состояний

## 4. Технические требования

### 4.1 Архитектура
- **Монорепозиторий**: yarn workspaces
- **Структура**:
```
misc/
├── backend/      # Nest.js + TypeScript
├── frontend/     # React + TypeScript + Vite
├── shared/       # Общие типы и утилиты
└── package.json
```

### 4.2 Backend (для будущего MVP)
- **Framework**: Nest.js
- **Язык**: TypeScript
- **Архитектура**: Clean Architecture с Dependency Injection
- **База данных**: PostgreSQL (в MVP)

### 4.3 Frontend
- **Framework**: React
- **Язык**: TypeScript
- **Сборщик**: Vite
- **Стилизация**: vanilla CSS с CSS Variables для минимализма
- **State Management**: React hooks (useState, useReducer)

### 4.4 Shared
- **Типы**: TypeScript интерфейсы для записей, тегов
- **Утилиты**: Валидация тегов, нормализация
- **Константы**: Ограничения, настройки по умолчанию

## 5. Настройки

### 5.1 Пользовательские настройки
- **Регистрозависимость**: Вкл/Выкл (по умолчанию: выкл)
- **Живой поиск**: Вкл/Выкл (по умолчанию: вкл)
- **Максимальная длина тега**: Число (по умолчанию: 100)
- **Максимальная длина записи**: Число (по умолчанию: 1000)

## 6. Этапы разработки

### 6.1 Прототип (Текущий этап)
- [ ] Базовая структура монорепозитория
- [ ] Frontend приложение с localStorage
- [ ] Создание, поиск, редактирование, удаление записей
- [ ] Облако тегов и список записей
- [ ] Автодополнение тегов
- [ ] Экспорт/импорт данных
- [ ] Клавиатурная навигация

### 6.2 MVP (Следующий этап)
- [ ] Backend на Nest.js
- [ ] PostgreSQL для хранения
- [ ] Авторизация пользователей
- [ ] Синхронизация между устройствами
- [ ] API для внешних интеграций

### 6.3 Дальнейшее развитие
- [ ] Мобильные приложения (PWA → Native)
- [ ] CLI версия
- [ ] Браузерное расширение
- [ ] Командные пространства
- [ ] Премиум функции

## 7. Пользовательские сценарии

### 7.1 Первое использование
1. Пользователь открывает приложение
2. Видит пустое поле ввода с плейсхолдером
3. Начинает вводить теги через пробел
4. Нажимает Enter - запись сохранена
5. Поле очищается, готово для новой записи

### 7.2 Поиск информации
1. Пользователь вводит один или несколько тегов
2. Видит результаты в реальном времени
3. Если много результатов - видит облако тегов
4. Кликает по тегу в облаке для уточнения
5. Находит нужную запись

### 7.3 Редактирование записи
1. Пользователь находит запись через поиск
2. Кликает по записи или выбирает стрелками + Enter
3. Запись загружается в поле ввода
4. Редактирует содержимое
5. Нажимает Enter - создаётся новая версия записи

## 8. Примеры использования

### 8.1 Контакты
```
иван петров телефон 79161234567 email ivan@mail.ru день-рождения 15-марта
```

### 8.2 Пароли
```
github пароль qwerty123 логин developer@gmail.com 2fa-enabled
```

### 8.3 Заметки
```
встреча завтра 15:00 офис обсудить бюджет проект-альфа
```

### 8.4 Списки покупок
```
купить молоко хлеб яйца сыр магазин-у-дома
```

## 9. Ограничения прототипа

- **Объём данных**: До 5-10MB (localStorage)
- **Многопользовательность**: Отсутствует
- **Синхронизация**: Отсутствует
- **Резервное копирование**: Только через экспорт
- **Fuzzy поиск**: Отсутствует (нет поиска с учётом опечаток)

## 10. Критерии приёмки

### 10.1 Функциональные
- Создание записи работает с любыми Unicode символами
- Поиск находит записи по всем введённым тегам
- Экспорт создаёт валидный JSON файл
- Импорт восстанавливает все данные включая UUID
- Все горячие клавиши работают как описано

### 10.2 Нефункциональные
- Приложение загружается менее чем за 2 секунды
- Поиск работает без заметных задержек до 1000 записей
- Интерфейс адаптируется под мобильные экраны
- Нет потери данных при обновлении страницы

## 11. Риски и ограничения

### 11.1 Технические риски
- **localStorage лимиты**: Решение - предупреждение пользователя о приближении к лимиту
- **Производительность поиска**: Решение - индексация и оптимизация
- **Конфликты UUID**: Решение - использование надёжной библиотеки генерации

### 11.2 UX риски
- **Путаница с "редактированием"**: Решение - четкая документация поведения
- **Потеря данных при удалении**: Решение - подтверждение удаления в будущих версиях
- **Дублирование при опечатках**: Решение - агрессивное автодополнение

## 12. Метрики успеха

- **Технические**: Покрытие тестами > 80%, нулевые критические баги
- **Пользовательские**: Время до продуктивного использования < 1 минуты
- **Бизнес**: 100+ активных пользователей прототипа для валидации концепции
