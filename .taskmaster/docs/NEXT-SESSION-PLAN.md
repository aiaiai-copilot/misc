# üéØ –ü–ª–∞–Ω –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–π —Å–µ—Å—Å–∏–∏

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-10-03
**–¢–µ–∫—É—â–∞—è –≤–µ—Ç–∫–∞:** `task/4-implement-rest-api-endpoints`

---

## üìã –ü–†–ò–û–†–ò–¢–ï–¢ 1: –ó–∞–≤–µ—Ä—à–∏—Ç—å Task 4.3

### –°—Ç–∞—Ç—É—Å

- ‚úÖ **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ**
- ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞** (Build + TypeCheck + Lint + Tests: 46/46)
- ‚è≥ **–û–∂–∏–¥–∞–µ—Ç –∫–æ–º–º–∏—Ç–∞**

### –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

1. –ú–µ—Ç–æ–¥ `getTagStatistics()` –≤ RecordRepository interface
2. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ PostgresRecordRepository (SQL —Å UNNEST)
3. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ LocalStorageRecordRepository
4. –≠–Ω–¥–ø–æ–∏–Ω—Ç `GET /api/tags` –≤ API router
5. 3 –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–∞ —Å PostgreSQL
6. –¢–µ—Å—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Ä–æ—É—Ç–∞ –≤ Express

### –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

```
packages/application/src/ports/record-repository.ts
packages/infrastructure/postgresql/src/postgres-record-repository.ts
packages/infrastructure/postgresql/src/__tests__/postgres-record-repository-integration.test.ts
packages/infrastructure/localStorage/src/localstorage-record-repository.ts
packages/backend/src/routes/api.ts
packages/backend/src/routes/__tests__/api.test.ts
```

### –î–µ–π—Å—Ç–≤–∏—è –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

1. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–º–∞–Ω–¥—É:**

   ```bash
   /complete-task
   ```

2. **–ü—Ä–æ—Ü–µ—Å—Å –±—É–¥–µ—Ç —Ç–∞–∫–æ–π:**
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (—É–∂–µ –ø—Ä–æ—à–ª–∞)
   - ‚è≥ –ó–∞–ø—Ä–æ—Å –æ–¥–æ–±—Ä–µ–Ω–∏—è –Ω–∞ —Ä—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
   - ‚è≥ –ü–æ—Å–ª–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è - —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–º–∏—Ç–∞
   - ‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞ - –ø–æ—Å–ª–µ–¥–Ω–∏–π –ª–∏ —ç—Ç–æ subtask
   - ‚è≥ –ï—Å–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π - —Å–æ–∑–¥–∞–Ω–∏–µ PR

3. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - –ö–æ–º–º–∏—Ç —Å–æ–∑–¥–∞–Ω
   - Task 4.3 –ø–æ–º–µ—á–µ–Ω –∫–∞–∫ done
   - –ï—Å–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π subtask ‚Üí Task 4 –ø–æ–º–µ—á–µ–Ω done + PR —Å–æ–∑–¥–∞–Ω

---

## üìã –ü–†–ò–û–†–ò–¢–ï–¢ 2: Task 11 - Fix ES Module Resolution

### –°—Ç–∞—Ç—É—Å

- üî¥ **HIGH PRIORITY**
- üìÑ **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞**
- ‚è≥ **–ì–æ—Ç–æ–≤–∞ –∫ –Ω–∞—á–∞–ª—É —Ä–∞–±–æ—Ç—ã**

### –ü—Ä–æ–±–ª–µ–º–∞

Backend –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏–∑-–∑–∞ –æ—à–∏–±–∫–∏:

```
Error: Cannot find module '/packages/domain/dist/tag-normalizer'
```

**–ü—Ä–∏—á–∏–Ω–∞:** TypeScript –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç –∏–º–ø–æ—Ä—Ç—ã –±–µ–∑ `.js` —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π, –Ω–æ Node.js ESM —Ç—Ä–µ–±—É–µ—Ç –∏—Ö.

### –†–µ—Å—É—Ä—Å—ã

**–î–µ—Ç–∞–ª—å–Ω—ã–π –≥–∞–π–¥:** `.taskmaster/docs/task-11-es-modules-guide.md`

–°–æ–¥–µ—Ä–∂–∏—Ç:

- –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
- –î–≤–∞ —Ä–µ—à–µ–Ω–∏—è (CommonJS –±—ã—Å—Ç—Ä–æ–µ / ESM –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ)
- –ü–æ—à–∞–≥–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
- –ü–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –°–ø–∏—Å–æ–∫ –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã—Ö —Ñ–∞–π–ª–æ–≤

### –î–µ–π—Å—Ç–≤–∏—è –¥–ª—è —Å—Ç–∞—Ä—Ç–∞

1. **–ü—Ä–æ—á–∏—Ç–∞—Ç—å –≥–∞–π–¥:**

   ```bash
   cat .taskmaster/docs/task-11-es-modules-guide.md
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å:**

   ```bash
   tm show 11
   ```

3. **–ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É:**

   ```bash
   tm set-status --id=11 --status=in-progress
   git checkout -b fix/es-modules-task-11
   ```

4. **–ü–æ–ª—É—á–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é —á–µ—Ä–µ–∑ Context7:**

   ```bash
   # TypeScript ESM
   # Node.js ESM
   # (–ø—Ä–∏–º–µ—Ä—ã –≤ –≥–∞–π–¥–µ)
   ```

### –í–∞—Ä–∏–∞–Ω—Ç—ã —Ä–µ—à–µ–Ω–∏—è

**–ë—ã—Å—Ç—Ä–æ–µ (15 –º–∏–Ω):** –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ CommonJS

- –£–¥–∞–ª–∏—Ç—å `"type": "module"` –∏–∑ package.json
- –ò–∑–º–µ–Ω–∏—Ç—å tsconfig ‚Üí `"module": "commonjs"`
- –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ (30-60 –º–∏–Ω):** –ù–∞—Å—Ç—Ä–æ–π–∫–∞ ESM

- –î–æ–±–∞–≤–∏—Ç—å `.js` –≤ –∏–º–ø–æ—Ä—Ç–∞—Ö –≤ –∏—Å—Ö–æ–¥–Ω–∏–∫–∞—Ö `.ts`
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å tsconfig –¥–ª—è ESM
- –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å

---

## üîß –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

```bash
tm list                    # –í—Å–µ –∑–∞–¥–∞—á–∏
tm show 4                  # –†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∞—è –∑–∞–¥–∞—á–∞
tm show 4.3                # –¢–µ–∫—É—â–∞—è –ø–æ–¥–∑–∞–¥–∞—á–∞
git status                 # Git –∏–∑–º–µ–Ω–µ–Ω–∏—è
git branch --show-current  # –¢–µ–∫—É—â–∞—è –≤–µ—Ç–∫–∞
```

### –í–∞–ª–∏–¥–∞—Ü–∏—è

```bash
yarn build:packages        # –°–±–æ—Ä–∫–∞
yarn tsc                   # TypeCheck
yarn validate              # –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
yarn validate:fast         # –ë—ã—Å—Ç—Ä–∞—è (–±–µ–∑ [perf])
```

### Backend –ø—Ä–æ–≤–µ—Ä–∫–∞ (–ø–æ—Å–ª–µ Task 11)

```bash
docker compose up -d postgres
yarn workspace @misc-poc/backend build
yarn workspace @misc-poc/backend start
curl http://localhost:3001/api/tags
```

---

## üìä –û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å

**Task 4 - REST API Endpoints:**

- Subtasks: 2/5 done (40%)
- 4.1 ‚úÖ Router
- 4.2 ‚úÖ CRUD endpoints
- 4.3 ‚è≥ **Tags endpoint (—Ç–µ–∫—É—â–∞—è)**
- 4.4 ‚è∏Ô∏è Validation middleware
- 4.5 ‚è∏Ô∏è Error handling

**Task 11 - ES Modules:**

- Status: Pending
- Priority: HIGH
- Dependencies: None
- Subtasks: Not expanded yet

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è

1. **–í–°–ï–ì–î–ê –ø—Ä–æ–≤–µ—Ä—è–π Docker** –ø–µ—Ä–µ–¥ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ —Ç–µ—Å—Ç–∞–º–∏

   ```bash
   docker ps  # –î–æ–ª–∂–µ–Ω –±—ã—Ç—å misc-postgres
   ```

2. **–ù–ï –¥–µ–ª–∞–π –∫–æ–º–º–∏—Ç** –±–µ–∑ –æ–¥–æ–±—Ä–µ–Ω–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏

3. **–£–≤–µ–ª–∏—á–∏–≤–∞–π timeout** –µ—Å–ª–∏ —Ç–µ—Å—Ç—ã timeout'—è—Ç—Å—è, –Ω–µ —É–º–µ–Ω—å—à–∞–π –ø–æ–∫—Ä—ã—Ç–∏–µ

4. **–û–¥–∏–Ω subtask –∑–∞ —Ä–∞–∑** - –Ω–µ –ø—Ä—ã–≥–∞–π –º–µ–∂–¥—É –∑–∞–¥–∞—á–∞–º–∏

5. **Context7 –ü–ï–†–ï–î –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º** –ª—é–±–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

---

**–ù–∞—á–Ω–∏ —Å–ª–µ–¥—É—é—â—É—é —Å–µ—Å—Å–∏—é —Å –∫–æ–º–∞–Ω–¥—ã:** `/complete-task`

_–≠—Ç–æ—Ç —Ñ–∞–π–ª –æ–±–Ω–æ–≤–ª—ë–Ω: 2025-10-03 10:20_
